#!/bin/csh -f
exit

# NHGRI DNASE I HYPERSENSITIVE SITES (2004-10-15 kate)
    # Data from Greg Crawford <crawford@mail.nih.gov> at the Collins Lab

    cd /cluster/data/encode/NHGRI

    set data = lab/DNaseI_HS_NHGRI_ENCODE2.txt
    sed '/^track/d' $data > DNAseHS.bed
    hgLoadBed hg16 encode_NHGRI_DNAseHS DNAseHS.bed


    # Stanford Promoters from Rick Myers lab (2004-10-17 kate)

    /cluster/data/encode/StanfordPromoters
    mkdir StanfordPromoters_20040825
    ln -s latest StanfordPromoters_20040825
    cd latest

    csh makePromoterFiles.csh > promoterExps.tab
    wc -l promoterExps.exp
        # 14

    # currently hgTracks only looks in hgFixed for the experiment table
    #  (add a trackDb option)
    hgExperiment hgFixed encode_Stanford_Promoters \
                    promoterExps.tab promoterPos.bed promoterData.tab
    hgLoadBed hg16 encode_Stanford_Promoters encode_Stanford_Promoters.tab


# UVA DNA REPLICATION TEMPORAL PROFILING (2004-10-22 kate)
    # Updated with new data 2005-05-17 kate
    # Dutta lab (Univ. Virginia) replication data
    #       Submitted as custom track, coords on hg15

    cd /cluster/data/encode/UVa
    mkdir 2004-10-22
    ln -s 2004-10-22 
    cd latest
    mkdir -p lab
    cd lab
    # download data
    # data (was MS-WORD)
    dos2unix lab/Dutta_Rep_profile.txt
    # documentation (ditto)
    dos2unix lab/UCSC-_data_release.txt

    # split file of customtracks into multiple files
    ./splitCustomTracks.pl lab/Dutta_Rep_profile.txt repl
    wc -l *.?-?{,?}
        # 163 repl.0-2
        # 301 repl.2-4
        # 296 repl.4-6
        # 523 repl.6-8
        # 421 repl.8-10
        # 1704 total

    wc -l lab/Dutta_Rep_profile.txt
      # 1704 lab/Dutta_Rep_profile.txt

    cat > checkEncodeTable.csh << 'EOF'
    hgsql hg16 -N -s -e "SELECT er.name, count(*) FROM encodeRegions er, $1 hs WHERE er.chrom=hs.chrom AND hs.chromStart between er.chromStart AND er.chromEnd group by er.name"
    'EOF'

    # load w/o binning to maintain ordering by chromStart
    foreach f (repl.?-?{,?})
        liftOver $f /cluster/data/hg15/bed/liftOver/hg15ToHg16.over.chain \
                    $f.hg16.bed $f.unmapped
        set time = `echo $f:e | sed 's/-/_/'`
        hgLoadBed -noBin hg16 encode_UVA_DNARep_$time $f.hg16.bed
        csh checkEncodeTable.csh encode_UVA_DNARep_$time > $time.ct
    end
    wc -l *.hg16.bed
        # 160 repl.0-2.hg16.bed
        # 298 repl.2-4.hg16.bed
        # 294 repl.4-6.hg16.bed
        # 520 repl.6-8.hg16.bed
        # 416 repl.8-10.hg16.bed
       # 1688 total
    wc -l *.unmapped
          # 0 repl.0-2.unmapped
          # 0 repl.2-4.unmapped
          # 0 repl.4-6.unmapped
          # 0 repl.6-8.unmapped
          # 0 repl.8-10.unmapped
          # 0 total
    cut -f 1 *.ct | sort | uniq > regions
    wc -l regions
     # 43 regions (1 missing)
    hgsql  hg16 -N -s -e "SELECT name from encodeRegions" | sort | diff - regions 

    # UPDATED 2005-05-17 WITH NEW DATA
    mkdir -p 2005-05-17
    ln -s 2005-05-17 latest
    cd latest
    mkdir -p lab
    cd lab
    # symlink to nicer names
    ln -s encode0to2vs0to10AunionD_interval_pval_43.bed repl.0
    ln -s encode2to4vs0to10AunionD_interval_pval_43.bed repl.2
    ln -s encode4to6vs0to10AunionD_interval_pval_43.bed repl.4
    ln -s encode6to8vs0to10AunionD_interval_pval_43.bed repl.6
    ln -s encode8to10vs0to10AunionD_interval_pval_43.bed repl.8
    wc -l repl.*
    # 232 repl.0
    # 493 repl.2
    # 295 repl.4
    # 528 repl.6
    # 425 repl.8
    # 1973 total

    foreach F (lab/repl.?)
        set f = $F:t
        echo $f
        liftOver $f /cluster/data/hg15/bed/liftOver/hg15ToHg16.over.chain \
                    $f.hg16.bed $f.unmapped
        set time = `echo $f:e`
        hgLoadBed -noBin hg16 encodeUvaDnaRep$time $f.hg16.bed
        csh /cluster/data/encode/UVa/2004-10-22/checkEncodeTable.csh encodeUvaDnaRep_$time > $time.ct
    end
    


# UCSD CHIP/CHIP (2004-09-30 kate)
    # Bing Ren's Lab
    # Provided by Chunxu Qu [mailto:qchunxu@ucsd.edu] on Oct. 1, 2004

    # Unpack data and rename files 

    ssh kksilo
    cd /cluster/data/encode
    mkdir -p UCSD/project1
    cd UCSD/project1
    gunzip project1.tar.gz
    foreach f (*.wig)
        mv $f $f.bed
    end

    # consists of 8 custom track wiggle BED files
    ssh hgwdev
    mkdir /gbdb/hg16/encode/UCSD_ChIP/wib
    cd /cluster/data/encode/UCSD/project1
    mkdir wig
    cd wig
    cat > makeWig.csh << 'EOF'
    foreach f (../*.bed)
        # get base name
        set b = $f:t:r:r
        # strip non-informative parts of name
        set n = `echo $b | sed -e 's/ave_//' -e 's/_p//' | tr '[a-z]' '[A-Z]'`
        echo $n
        # create wiggle data files from BED
        # NOTE: wigBedToBinary has been replaced by wigEncode
        sed -e '/^browser/d' -e '/^track/d' $f | \
            wigBedToBinary stdin $n.wig $n.wib
        ln -s `pwd`/$n.wib /gbdb/hg16/encode/UCSD_ChIP/wib
        # load into database
        hgLoadWiggle hg16 encode_UCSD_ChIP_$n $n.wig \
                    -pathPrefix=/gbdb/hg16/encode/UCSD_ChIP/wib
    end
    'EOF'
    # << for emacs

    csh makeWig.csh >&! makeWig.log &
    # Converted stdin, upper limit 16.00, lower limit 0.00, etc.

    hgsql hg16 -s -e "select count(*) from encode_UCSD_ChIP_RNAP_HELA"
        # 19571

    # create entries in trackDb, default height 16 pixels
    # Use Jim's suggestion to associate a color with a cell line
         # Pol2 Hela (black)
         # Pol2 THP1 (darkish blue)
         # Pol2 IMR90 (darkish red)
         # Pol2 HCT116 (darkish green)
         # TAF1 Hela (black)
         # TAF1 THP1 (darkish blue)
         # TAF1 IMR90 (darkish red)
         # TAF1 HCT116 (darkish green)

    # UCSD/Ludwig Institute Histone Methylation (2005-04-21 kate)
    # NOTE: this data was submitted 12/14/04, but somehow fell thru
    # the cracks (it was the week before CSHL).
    # Files received from email:  ave_AcH3_imr90.wig ave_MeH3K4_imr90.wig
# Provided by Chunxu Qu [mailto:qchunxu@ucsd.edu]

    cd /cluster/data/encode/UCSD
    cd project1
    mv ave_AcH3_imr90.wig ave_AcH3_imr90_p.wig.bed
    mv ave_MeH3K4_imr90.wig ave_MeH3K4_imr90_p.wig.bed
    mkdir -p /gbdb/hg16/encode/UcsdChip/wib
    mkdir wig.2005-04-21
    cd latest
    # edit makeWig.csh to use wigEncode and standard table naming
    cat > makeWig.csh << 'EOF'
    foreach f (../*.bed)
        # get base name
        set b = $f:t:r:r
        # convert to standard format (initial caps) "AntibodyCell"
        set n = `echo $b | perl -wpe 's/ave_(.*)_(.*)_p/\u\L$1\E\u\L$2\E/'`
        echo $n
        # create wiggle data files from BED
        sed -e '/^browser/d' -e '/^track/d' $f | \
            wigEncode stdin $n.wig $n.wib
        ln -s `pwd`/$n.wib /gbdb/hg16/encode/UcsdChip/wib
        # load into database
        hgLoadWiggle hg16 encodeUcsdChip$n $n.wig \
                    -pathPrefix=/gbdb/hg16/encode/UcsdChip/wib
    end
'EOF'
    # << for emacs
    csh makeWig.csh >&! makeWig.log &

    # cleanup TODO: remove old /gbdb files, doc files, tables 
    # on hgwdev, beta & RR

    # try as bedGraph type 
    cd /cluster/data/encode/UCSD
    cd project1
    mkdir bed.2005-04-21
    ln -s bed.2005-04-21 latest
    cd latest 
    cat > makeBed.csh << 'EOF'
    foreach f (../*.bed)
        # get base name
        set b = $f:t:r:r
        # convert to standard format (initial caps) "AntibodyCell"
        set n = `echo $b | perl -wpe 's/ave_(.*)_(.*)_p/\u\L$1\E\u\L$2\E/'`
        echo $n
        # create wiggle data files from BED
        sed -e '/^browser/d' -e '/^track/d' $f > $n.bed
        # load into database
        hgLoadBed hg16 encodeUcsdChip$n $n.bed
    end
'EOF'
    # << for emacs
    csh makeBed.csh >&! makeBed.log &
    # set up 4 composite tracks (per antibody), 4 cell lines each
    # using colors to highlight cell types:
         # Hela (black)
         # THP1 (darkish blue)
         # IMR90 (darkish red)
         # HCT116 (darkish green)


# STANFORD MLAGAN MSA OF FREEZE2 (2004-11-17 kate)
#       From George Asimenos, Batzoglou lab (asimenos@stanford.edu)
    
    cd /cluster/data/encode
    cd MLAGAN/freeze2
    mkdir lab out tmp
    set tmpDir = /cluster/data/encode/MLAGAN/freeze2/tmp
    set outDir = /cluster/data/encode/MLAGAN/freeze2/out
    cd lab
    wget -r http://ai.stanford.edu/~asimenos/beta_encode_Nov_2004/
    mv ai.stanford.edu/*asimenos/beta* .
    rm -fr ai.stanford.edu
    cd beta_encode_Nov_2004/data
cat > makeMaf.csh << 'EOF'
    set tmpDir = /cluster/data/encode/MLAGAN/freeze2/tmp
    set outDir = /cluster/data/encode/MLAGAN/freeze2/out
    foreach r (EN*)
        echo $r
        set c = `echo "SELECT chrom from encodeRegions WHERE name='$r'" | \
                        hgsql -N hg16`
        set start =  \
                `echo "SELECT chromStart from encodeRegions WHERE name='$r'" | \
                        hgsql -N hg16`
        set size = \
                `echo "SELECT size from chromInfo WHERE chrom='$c'" | \
                        hgsql -N hg16`
        bunzip2 -c $r/$r.maf.bz2 | \
          /cluster/data/encode/MLAGAN/mafCoord.pl human hg16.$c $start $size |\
            sed 's/^a$/a score=0.0/' > $tmpDir/$r.db.maf
        /cluster/bin/penn/maf_project $tmpDir/$r.db.maf hg16.$c \
                        > $outDir/$r.human.maf
    end
'EOF'
    csh makeMaf.csh >&! makeMaf.log &

    mkdir /gbdb/hg16/encode_MSA2_MLAGAN
    ln -s $outDir/*.human.maf /gbdb/hg16/encode_MSA2_MLAGAN
    hgLoadMaf -WARN hg16 encode_MSA2_MLAGAN

    # create description page from lab/index.html


# AFFY TRANSCRIPTION AND CHIP/CHIP TEMPORAL PROFILING (2004-12-08 kate)

    # HL60 cells stimulated with Retinoic Acid
    # Transcription and PolII ChIP/Chip at 4 timepoints (8 experiments)
    # wig & bed for each experiment 
    # filenames: EC_HL60_RA_RNA_00hr_AS.hs.NCBIv34.{bed,wig}
    #            EC_HL60_RA_RNApol2_00hr_AS_b.hs.NCBIv34.{bed,wig}
    # Use these to construct 16 tracks:
    # track encodeAffyRnaHl60Hr{00,02,08,32}
    # track encodeAffyChIpRnapHl60Hr{00,02,08,32}
    # RNA/Affy HL60 0hr
    # ChIP/Affy Pol2 0hr

    mkdir -p /gbdb/hg16/encode/Affy/2004-12-03/wib
    cd /cluster/data/encode
    mkdir -p Affy/Dec03_2004
    cd Affy/Dec03_2004
    wget http://transcriptome.affymetrix.com/download/ENCODE/ucsc_formats.tar.bz2
    bunzip2 ucsc_formats.tar.bz2
        # trailing garbage after EOF ignored
    tar xvf ucsc_formats.tar
    # NOTE: the script below creates $hrs as 0,2,8,32
    # and tables were renamed to 00,02,08,32, so change script
    # next time it's loaded.
    cd ucsc_formats
cat > load.csh << 'EOF'
    foreach f (bed/*.bed)
        set base = $f:t:r
        set info = `echo $f:t | sed 's/EC_HL60_RA_\([^_][^_]*\)_\([0-9][0-9]*\)hr.*/\1.\2/'`
        set hrs = `expr $info:e + 0`
        set exp = `echo $info:r |  \
                        sed -e 's/RNApol2/ChIpRnap/' -e 's/RNA/Rna/'`
        if ($exp == "Rna") then
            set meas = "Sig"
        else
            set meas = "Pval"
        endif
        set track = encodeAffy${exp}Hl60SitesHr$hrs
        sed '1d' $f | \
            hgLoadBed -noBin hg16 $track stdin
        set ct = `hgsql -N -s -e "select count(*) from $track" hg16`
        echo "track $track"
        echo "$f:t	$ct"
        set track = encodeAffy${exp}Hl60${meas}Hr$hrs
        sed '/^track/d' wig/$base.wig | wigEncode stdin $track.wig $track.wib
        ln -s `pwd`/$track.wib /gbdb/hg16/encode/Affy/2004-12-03/wib
        # load into database
        hgLoadWiggle hg16 ${track} $track.wig \
                    -pathPrefix=/gbdb/hg16/encode/Affy/2004-12-03/wib
    end
'EOF'
    # << for emacs
    csh load.csh >&! load.log &
    grep EC_HL60 load.log | grep -v wig > loaded.txt
    # email loaded.txt to contributor
    awk '{print $1}' bed/*.bed | sort | uniq > chroms.txt
    # use in trackDb chromosomes setting
    grep encodeAffy load.log > trackDb.ra
    # use as basis of hg16 trackDb entries
    # (create 4 composite tracks)

    cd description
    # edit
    cp EC_HL60_RA_RNA_00hr_AS_hs.NCBIv34.bed.dsc encodeAffyRnaHl60Sites.html
    cp EC_HL60_RA_RNA_00hr_AS_hs.NCBIv34.wig.dsc encodeAffyRnaHl60Sig.html
    cp EC_HL60_RA_RNApol2_00hr_AS_hs.NCBIv34.bed.dsc encodeAffyChIpRnapHl60Sites.html
    cp EC_HL60_RA_RNApol2_00hr_AS_hs.NCBIv34.wig.dsc encodeAffyChIpRnapHl60Pval.html


# BOSTON UNIVERSITY / ZHIPING WENG LAB FIRST EXON DATA (WORKING 2005-01-27 kate)

    ssh kksilo
    cd /cluster/data/encode
    mkdir -p BU
    cd BU
    #mkdir -p 2005-01-06
    #ln -s 2005-01-06/latest
    #cd latest
    # copy file from email:  BED.tar.gz
    #tar xvfz BED.tar.gz

    #mkdir -p 2005-04-29
    #ln -s 2005-04-29/latest
    mkdir -p 2005-05-04
    ln -s 2005-05-04 latest
    cd latest
    # save file from email
    tar xvfz BED.BUMay4.tar.gz

    cd BED
    cp rcPCREncodeDataDescription.html ~/kent/src/hg/makeDb/trackDb/human/hg16/encodeBuFirstExon.html
    # checkin description file and edit
    cd ..

    # adjust chromStart
    cat > lowerStart.awk << 'EOF'
        {printf ("%s\t%d\t%d\t%s\t%d\t%s\t%d\t%d\t%s\t%d\t%d\t%d\t%s\n",
                    $1, $2-1, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13);}
'EOF'
    # rearrange data colums to be BED 13, add RGB values to "reserved" field
    # based on score
    makeColoredBed < BED/cerebralcortex.bed | \
                        awk -f lowerStart.awk > encodeBuFirstExonCerebrum.bed
    makeColoredBed < BED/colon.bed  | \
                        awk -f lowerStart.awk > encodeBuFirstExonColon.bed
    makeColoredBed < BED/heart.bed  | \
                        awk -f lowerStart.awk > encodeBuFirstExonHeart.bed
    makeColoredBed < BED/kidney.bed  | \
                        awk -f lowerStart.awk > encodeBuFirstExonKidney.bed
    makeColoredBed < BED/liver.bed  | \
                        awk -f lowerStart.awk > encodeBuFirstExonLiver.bed
    makeColoredBed < BED/lung.bed  | \
                        awk -f lowerStart.awk > encodeBuFirstExonLung.bed
    makeColoredBed < BED/skeletalmuscle.bed  | \
                        awk -f lowerStart.awk > encodeBuFirstExonSkMuscle.bed
    makeColoredBed < BED/spleen.bed  | \
                        awk -f lowerStart.awk > encodeBuFirstExonSpleen.bed
    makeColoredBed < BED/stomach.bed  | \
                        awk -f lowerStart.awk > encodeBuFirstExonStomach.bed
    makeColoredBed < BED/testis.bed  | \
                        awk -f lowerStart.awk > encodeBuFirstExonTestis.bed

    # take a look at data distribution (previous was skewed toward 0)
    awk '{print $5}' *.bed | sort -n > scores.txt
    textHistogram scores.txt -binSize=100 -maxBinCount=11
    # 0       107.000000
    # 100     8.000000
    # 200     32.000000
    # 300     53.000000
    # 400     91.000000
    # 500     130.000000
    # 600     186.000000
    # 700     118.000000
    # 800     33.000000
    # 900     1.000000
    # 1000    1.000000
    ## cluster at 0, followed by a nice bell curve

    cat > load.csh << 'EOF'
    foreach f (Cerebrum Colon Heart Kidney Liver Lung SkMuscle Spleen Stomach Testis)
        hgLoadBed hg16 -noBin encodeBuFirstExon encodeBuFirstExon$f.bed -sqlTable=${HOME}/kent/src/hg/lib/encodeBuFirstExon.sql
        hgsql hg16 -e "DROP TABLE IF EXISTS encodeBuFirstExon$f"
        hgsql hg16 -e "ALTER TABLE encodeBuFirstExon RENAME TO encodeBuFirstExon$f"
    end
'EOF'

    csh load.csh >&! load.log

    # generate list of chromosomes with data for trackDb entry
    foreach f (Cerebrum Colon Heart Kidney Liver Lung SkMuscle Spleen Stomach Testis)
        /cluster/data/encode/scripts//showChromList.csh hg16 encodeBuFirstExon$f
    end
        #chr11,chr13,chr15,chr16,chr19,chr2,chr5,chr7,chr9,chrX


# GENCODE Sanger Havana annotations (hiram)
#               (IN PROGRESS 2005-03-21 kate)
    ssh hgwdev
    mkdir -p /cluster/data/encode/Gencode
    cd /cluster/data/encode/Gencode
    wget --timestamping --force-directories --directory-prefix=. \
	--dont-remove-listing --recursive --level=3 --no-parent \
	--no-host-directories --cut-dirs=5 \
	"ftp://genome.imim.es/pub/other/gencode/data/havana-encode/*"
#  This fetches the directories:
#	drwxrwxr-x  2 4096 Mar  7 16:01 CHR_coord
#	drwxrwxr-x  2 4096 Mar  7 16:02 ENCODE_coord
#	-rw-r--r--  1 2874 Feb 10 13:44 README.txt
#	drwxrwxr-x  4 4096 Mar  7 16:02 old

    # special handling for ENm006 -- submitted in hg17 coords
    # convert hg17 coord file to hg16 using liftOver 
    cd CHR_coord
    liftOver -gff ENm006_hg17_CHR_coord.gtf \
        /cluster/data/hg17/bed/liftOver/hg17ToHg16.chain \
                ENm006_CHR_coord.mapped.gtf unmapped
    # check coordinates and manually adjust as needed 
    ldHgGene -gtf -genePredExt hg16 encodeGencodeENm006 ENm006_CHR_coord.mapped.gtf
# invalid gffGroup detected on line: chrX VEGA_Known      exon    153120186      153120333        0.000000        +       .       gene_id "F8"; transcript_id "RP11-115M6.7-003"; 
# GFF/GTF group RP11-115M6.7-003 on chrX-, this line is on chrX+, all group members must be on same seq and strand
    # manually blat exon and CDS coords for this exon (exon-1)
    # they map to same place as liftOver, but on - strand.
    # edit 2 entires in the ".fixed" file to reflect this
    ldHgGene -gtf -genePredExt hg16 encodeGencodeENm006 ENm006_CHR_coord.fixed.gtf
    # Read 292 transcripts in 4564 lines in 1 files
    # 292 groups 1 seqs 13 sources 3 feature types
    # 292 gene predictions
    checkTableCoords hg16 encodeGencodeENm006
    # hg16.encodeGencodeENm006 has 10 records with blockStart[0] != start.
    #hg16.encodeGencodeENm006 has 7 records with blockEnd[n-1] != end.
    # run with -verbose=2
    ldHgGene -gtf -genePredExt hg17 encodeGencodeENm006 ENm006_hg17_CHR_coord.gtf
    # 293 gene predictions
    checkTableCoords hg17 encodeGencodeENm006

    # for now, load w/o ENm006
    # load all
    ldHgGene -gtf -genePredExt hg16 encodeGencodeGene EN????_CHR_coord.gtf
    # 777 gene predictions

    ldGencodeIntron hg16 encodeGencodeIntron EN????_CHR_coord.gtf
    # 4023 introns in 12 files

    # UPDATE 4/22/05

    cd /cluster/data/encode/Gencode
    mkdir 2005-04-22
    ln -s 2005-04-22 latest
    cd latest
    wget --timestamping --force-directories --directory-prefix=. \
	--dont-remove-listing --recursive --level=3 --no-parent \
	--no-host-directories --cut-dirs=5 \
	"ftp://genome.imim.es/pub/other/gencode/data/havana-encode/*"
    # Downloaded: 96,693,888 bytes in 488 files
    cat `ls CHR_coord_hg17/global_files/EN*coord.gtf | grep -v ENm006` > \
        gencode.noENm006
    liftOver -gff gencode.noENm006 \
            /cluster/data/hg17/bed/liftOver/hg17ToHg16.chain \
                gencode.gtf gencode.unmapped
     wc -l gencode.gtf
        # 40857 mapped GTF entries
     grep -v "in new" *.unmapped | wc -l
        # 19 unmapped GTF entries 
     grep -v "in new" *.unmapped | awk '{print $12}' | sort | uniq | wc -l
        # 8 unmapped gene ID's
    ldHgGene -gtf -genePredExt hg16 encodeGencodeGeneNew gencode.gtf
        # Read 2602 transcripts in 40856 lines in 1 files
    checkTableCoords hg16 encodeGencodeNew
    grep -v not_tested gencode.gtf | \
        ldGencodeIntron hg16 encodeGencodeIntronNew stdin
            # 425 introns in 1 files

# Sanger Chip/chip  (DONE 2005-03-14 kate)
    ssh hgwdev
    cd /cluster/data/encode/sanger/
    mkdir -p chipchip/2005-02-15
    cd chipchip/2005-02-15

    # obtain data files from ftp site
    cp /var/ftp/encode/H3K4me3_GM06990_1.description.txt .
    cp /var/ftp/encode/H3K4me3_GM06990_1.wig.txt .
    rm /var/ftp/encode/H3K*.txt

    # 4 columns: chrom, start, end, score (float)
    # data value range is .12 to 74.875
    # format as BED file
    grep "^chr" H3K4me3_GM06990_1.wig.txt > H3K4me3_GM06990_1.bed

    # create table schema for BED 4 with float score
    cat > table.sql << 'EOF'
    CREATE TABLE tablename (
        chrom varchar(255) not null,        # Chromosome (this species)
        chromStart int unsigned not null,   # Start position in chromosome (forward strand)
        chromEnd int unsigned not null,     # End position in chromosome
        score float not null,       # Overall score
                  #Indices
        INDEX(chrom(13),chromStart),
        INDEX(chrom(13),chromEnd)
    );
    'EOF'

    set tablename = encodeSangerChipH3me3GM06990
    sed "s/tablename/$tablename/" table.sql > $tablename.sql

    hgsql hg16 < $tablename.sql
    hgLoadBed -noBin -sqlTable=$tablename.sql hg16 $tablename H3K4me3_GM06990_1.bed
    # Loaded 17604 elements of size 4

    # create trackDb entry:

    # type bedGraph 4
    # shortLabel ChIP/Sanger
    # longLabel Sanger ChIP/Chip (H3K4me3 GM06990) in ENCODE Regions
    # minLimit 0
    # maxLimit 75


# Genome Institute of Singapore -ChIP/PET of p53 TFBS (IN PROGRESS 2005-03-31 kate)
    cd /cluster/data/encode
    mkdir -p GIS/2005-04-07
    cd GIS/2005-04-07
    # files: description.html, p53ChIP-PET.bed

    sed '1d' p53ChIP-PET.bed | hgLoadBed hg16 encodeGisChipPet stdin
    # Loaded 65513 elements of size 12


