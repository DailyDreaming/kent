
# Nematostella vectensis DOE JGI Nemve1

# $Id: nemVec1.txt,v 1.2 2008/07/14 21:58:15 kord Exp $
# $Source: /projects/compbio/cvsroot/kent/src/hg/makeDb/doc/nemVec1.txt,v $

#######################################################################
# CREATE BUILD DIRECTORY 
# (DONE 2008-Jul-01 - Kord) 

# what store?
ssh hgwdev
df -h            
# Filesystem            Size  Used Avail Use% Mounted on
# /dev/sda3             9.7G  5.9G  3.3G  65% /
# /dev/sda1              99M   36M   58M  39% /boot
# none                   16G     0   16G   0% /dev/shm
# /dev/sda5              20G   15G  3.5G  81% /scratch
# /dev/sdd1             1.5T  626G  767G  45% /data
# /dev/sde1             2.0T  1.8T  120G  94% /data/mysql
# kkhome-10:/export/cluster/home
#                       766G  415G  291G  59% /cluster/home
# ...
# kkstore06-10:/export/cluster/store3
#                       2.3T  1.9T  302G  87% /cluster/store3
# ...
ssh kkstore06
mkdir /cluster/store3/nemVec1
ln -s /cluster/store3/nemVec1 /cluster/data/nemVec1

#######################################################################
# DOWNLOAD THE ASSEMBLY 
# (DONE - 2008-Jul-05 - Kord)
ssh kkstore06
cd /cluster/data/nemVec1
mkdir jkStuff
mkdir bed

mkdir /cluster/data/nemVec1/downloads
cd /cluster/data/nemVec1/downloads

# GenBank WGS sequences and Scaffolds:
# http://www.ncbi.nlm.nih.gov/entrez/viewer.fcgi?db=nucleotide&val=ABAV01000000
# WGS         ABAV01000001-ABAV01059149
# WGS_SCAFLD  DS469507-DS480310

# JGI supplied contigs
# http://genome.jgi-psf.org/Nemve1/Nemve1.download.ftp.html
# Unmasked
wget --timestamp \
ftp://ftp.jgi-psf.org/pub/JGI_data/Nematostella_vectensis/v1.0/assembly/Nemve1.fasta.gz
faSize Nemve1.fasta.gz
# 356613585 bases (59221913 N's 297391672 real 297391672 upper 0 lower) in 10804 sequences in 1 files
# Total size: mean 33007.6 sd 149445.1 min 626 (scaffold_6071) max 3256212 (scaffold_1) median 6708
# N count: mean 5481.5 sd 10915.3
# U count: mean 27526.1 sd 141670.8
# L count: mean 0.0 sd 0.0
# %0.00 masked total, %0.00 masked real

# Masked
wget --timestamp \
ftp://ftp.jgi-psf.org/pub/JGI_data/Nematostella_vectensis/v1.0/assembly/Nemve1.allmasked.gz
faSize Nemve1.allmasked.gz
# 356613585 bases (59221913 N's 297391672 real 216553990 upper 80837682 lower) in 10804 sequences in 1 files
# Total size: mean 33007.6 sd 149445.1 min 626 (scaffold_6071) max 3256212 (scaffold_1) median 6708
# N count: mean 5481.5 sd 10915.3
# U count: mean 20043.9 sd 107371.3
# L count: mean 7482.2 sd 35162.7
# %22.67 masked total, %27.18 masked real

# Tandemly repated
wget --timestamp \
ftp://ftp.jgi-psf.org/pub/JGI_data/Nematostella_vectensis/annotation/v1.0/NvTRjug.fasta.gz
faSize NvTRjug.fasta.gz
# 14414 bases (0 N's 14414 real 14414 upper 0 lower) in 10 sequences in 1 files
# Total size: mean 1441.4 sd 2104.8 min 191 (GTGTTTGTGGTGTTTTjuggernaut) max 7162 (AAAAAAAAATCGAACAjuggernaut) median 786
# N count: mean 0.0 sd 0.0
# U count: mean 1441.4 sd 2104.8
# L count: mean 0.0 sd 0.0
# %0.00 masked total, %0.00 masked real

#######################################################################
# run the makeGenomeDb procedure to create the db and unmasked sequence
# (DONE - 2008-Jul-14 - Kord)

# create a new genomeClade?
# Nope - Jim doesn't want one-browser clades in the menu
# So, its into "other" for Nematostella until Hydra magnipapillata is done

# gnerate a fake AGP for use in downstream tools
ssh kkstore06
cd /cluster/data/nemVec1/downloads
hgFakeAgp -minContigGap=50 Nemve1.fasta.gz nemVec1.agp

cat << _EOF_ > nemVec1.config.ra
# Config parameters for makeGenomeDb.pl:
db nemVec1 
# new clade? cnidarian 
clade other
genomeCladePriority 18
scientificName Nematostella vectensis
commonName Starlet sea anemone
assemblyDate Jun. 2007
assemblyLabel US DOE JGI-PGF Nemve1
orderKey 227
mitoAcc none
fastaFiles /cluster/data/nemVec1/downloads/Nemve1.fasta.gz
agpFiles   /cluster/data/nemVec1/downloads/nemVec1.agp
# qualFiles /dev/null
dbDbSpeciesDir other
_EOF_

# run just to the AGP to make sure things are sane first
nice time -p makeGenomeDb.pl nemVec1.config.ra -stop agp \
    |tee -a jkStuff/makeGenomeDb.ajp 2>&1

# now, contining to make the Db and all
time -p nice -n +19 makeGenomeDb.pl nemVec1.config.ra -continue db \
    >jkStuff/makeGenomeDb.log 2>&1
# real 223.58
# user 0.20
# sys 0.16


cd /cluster/data/nemVec1/TemporaryTrackDbCheckout/kent/src/hg/makeDb/trackDb/other/nemVec1
# Updated the html
# description.html /cluster/data/nemVec1/html/{trackDb.ra,gap.html,gold.html}

 cd ../.. 
 # (to trackDb/) and
# - edit makefile to add nemVec1 to DBS.
# - (if necessary) cvs add other
# - cvs add other/nemVec1
# - cvs add other/nemVec1/*.{ra,html}
# - cvs ci -m "Added nemVec1 to DBS." makefile
# - cvs ci -m "Initial descriptions for nemVec1." other/nemVec1
# - (if necessary) cvs ci other
# - Run make update DBS=nemVec1 and make alpha when done.
# - (optional) Clean up /cluster/data/nemVec1/TemporaryTrackDbCheckout
# -  cvsup your ~/kent/src/hg/makeDb/trackDb and make future edits there.


