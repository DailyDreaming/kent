<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2//EN">

<HTML>
  <HEAD>
    <META name="generator" content=
    "HTML Tidy for Linux/x86 (vers 1st June 2002), see www.w3.org">

    <TITLE>GenBank/RefSeq Download Step</TITLE>
  </HEAD>

  <BODY bgcolor="white">
    <H1>GenBank/RefSeq Download Step</H1>
    The download step retrieves files from the NCBI ftp area and store the
    results in the <CODE>download/</CODE> directory. 

    <H3>Algorithm</H3>

    <UL>
      <LI>
        Run the <CODE>gbDownloadStep</CODE> script, which: 

        <UL>
          <LI>
            Downloads GenBank files: 

            <UL>
              <LI>Check if the GenBank release version has change from last
              version.</LI>

              <LI>If version changed, create a new version directory and
              download the full GenBank release and non-cumulative daily
              files.</LI>

              <LI>If the version is unchanged, download only the new,
              non-cumulative daily files.</LI>
            </UL>
          </LI>

          <LI>
            Downloads RefSeq files: 

            <UL>
              <LI>If the GenBank version changed, create a new RefSeq `version'
              directory name the current date and download the full
              database.</LI>

              <LI>If we are not changing versions, download new, daily
              files.</LI>
            </UL>
          </LI>
        </UL>
      </LI>
    </UL>

    <P>Note that this process isn't mirroring; it doesn't overwrite existing
    files. This minimizes the danger of leaving the data in an indeterminate
    state. Only the required subset of files are downloaded.</P>

    <H3><A name="dir">Directory structure</A></H3>
    The directory structure for GenBank and RefSeq are a subset of the
    directories at the NCBI ftp site. Release version numbers are added to the
    database directory names to allow keeping multiple versions. Since RefSeq
    doesn't actually do versioned releases, the GenBank version number is used
    for RefSeq as well. This implies that a full snapshot of RefSeq is obtained
    when a new GenBank release is made. This fake versioning of RefSeq supports
    both small, incremental downloads and allowing older files to be
    periodically removed. 

    <UL>
      <LI>
        <CODE>$gbRoot/data/download/</CODE> - downloaded files from NCBI ftp 

        <UL>
          <LI>
            <CODE>genbank/<EM>${ver}</EM>/</CODE> 

            <UL>
              <LI><CODE>README.genbank</CODE> - version number is parsed from
              text</LI>

              <LI><CODE>gbrel.txt</CODE> - release nodes</LI>

              <LI><CODE>gb*.seq.gz</CODE> - sequences, in flat-file format,
              grouped by division.</LI>

              <LI><CODE>full.md5</CODE> - md5 checksums for files downloaded
              with the full releases.</LI>

              <LI>
                <CODE>daily-nc/</CODE> 

                <UL>
                  <LI><CODE>nc0825.flat.gz</CODE> - flat-file update for a
                  08/25.</LI>

                  <LI><CODE>nc0825.flat.gz.md5</CODE> - md5 checksum for update
                  file</LI>

                  <LI>...</LI>
                </UL>
              </LI>
            </UL>
          </LI>

          <LI>
            <CODE>refseq.<EM>${ver}</EM></CODE> 

            <UL>
              <LI>
                <CODE>cummulative/</CODE> 

                <UL>
                  <LI><CODE>rscu.gbff.Z</CODE> - flat-file containing</LI>

                  <LI><CODE>rscu.gbff.Z</CODE> - flat-file containing full
                  RefSeq distribution as of date of download.</LI>

                  <LI><CODE>full.md5</CODE> - md5 checksum of all files</LI>
                </UL>
              </LI>

              <LI>
                <CODE>daily/</CODE> 

                <UL>
                  <LI><CODE>rsnc.0101.2002.gbff.Z</CODE> - Flat-file update for
                  01/01/2002.</LI>

                  <LI><CODE>rsnc.0101.2002.gbff.Z.md5</CODE> - md5
                  checksum</LI>

                  <LI>...</LI>
                </UL>
              </LI>
            </UL>
          </LI>
        </UL>
      </LI>
    </UL>
  </BODY>
</HTML>

