#!/bin/bash -e
#
# mgc-dbload [-inclEsts] [-extFileUpdate] [-allowLargeDeletes]
#
# dbload for mgc server.
#   - loads all MGC tables (in conf file)
opts="$*"

# initialize
gbRoot=/genbank
cd $gbRoot
. $gbRoot/lib/gbCommon.sh
databases=`gbGetDatabases etc/rr.dbs`

# load files copied to hgwnfs1
copyTime=var/copy/copy.time

# workdir is a local dir
workdir=/var/tmp/genbank

# data files and dirs
dbloadVar=var/dbload/`hostname`
copyTime=var/copy/copy.time
lastCopyTime=$dbloadVar/copy.time
lastCopyTimeTmp=$lastCopyTime.tmp
dbloadTime=$dbloadVar/dbload.time

exec $gbRoot/etc/dbload $opts $gbRoot "$databases" $copyTime $workdir
