#!/bin/bash -e

# Script to copy new processed and aligned from the build server to the this
# server (gbdb server) This polls to determine if an alignment has been done
# since the last time files were downloaded.  Remote file access is by rsync.

set -e  # errors terminate

# databases to copy:
databases="hg15 mm3 rn2"

# initialize
gbRoot=/scratch/genbank
cd $gbRoot
. $gbRoot/lib/gbCommon.sh

# local location of /gbdb
gbdb=/gbdb

# location of the genbank root and files on the remote build server
gbBuildServer=eieio
rsyncPort="ssh"
gbBuildRoot=/cluster/store5/genbank

# Checking for an existing lock file, Silently exits if lock file exists
# and is less than one day old,  error if older.
gbCheckLock $gbRoot/var/copy/run/copy.lock

exec gbCopyStep -rsyncPort=$rsyncPort -gbdb=$gbdb $gbBuildServer $gbBuildRoot $databases
