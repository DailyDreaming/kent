# genePix.sql was originally generated by the autoSql program, which also 
# generated genePix.c and genePix.h.  This creates the database representation of
# an object which can be loaded and saved from RAM in a fairly 
# automatic way.

#Location of image, typically a file directory
CREATE TABLE fileLocation (
    id int auto_increment not null,	# ID of fileLocation
    name longblob not null,	# Directory path usually
              #Indices
    PRIMARY KEY(id)
);

#Brain, eye, kidney, etc.  Use 'whole' for whole body
CREATE TABLE bodyPart (
    id int auto_increment not null,	# ID of body part
    name varchar(255) not null,	# Name of body part
              #Indices
    PRIMARY KEY(id),
    UNIQUE(name(32))
);

#Horizontal, coronal, whole mount, etc.
CREATE TABLE sliceType (
    id int auto_increment not null,	# ID of section
    name varchar(255) not null,	# Name transverse/sagittal/whole mount, etc
              #Indices
    PRIMARY KEY(id),
    UNIQUE(name(32))
);

#Fixation and other treatment conditions
CREATE TABLE treatment (
    id int auto_increment not null,	# ID of treatment
    conditions varchar(255) not null,	# Text string describing conditions
              #Indices
    PRIMARY KEY(id)
);

#Type of image - RNA in situ, fluorescent antibody, etc.
CREATE TABLE probeType (
    id int auto_increment not null,	# ID of image type
    name varchar(255) not null,	# Name of image type
              #Indices
    PRIMARY KEY(id)
);

#Info on contributor
CREATE TABLE contributor (
    id int auto_increment not null,	# ID of contributor
    name varchar(255) not null,	# Name in format like Kent W.J.
              #Indices
    PRIMARY KEY(id),
    INDEX(name(32))
);

#Information on a journal
CREATE TABLE journal (
    id int auto_increment not null,	# ID of journal
    name varchar(255) not null,	# Name of journal
    url varchar(255) not null,	# Journal's main url
              #Indices
    PRIMARY KEY(id)
);

#Info on a batch of images submitted at once
CREATE TABLE submissionSet (
    id int auto_increment not null,	# ID of submission set
    contributors longblob not null,	# Comma separated list of contributors in format Kent W.J., Wu F.Y.
    publication longblob not null,	# Name of publication
    pubUrl longblob not null,	# Publication URL
    journal int not null,	# Journal for publication
    setUrl longblob not null,	# URL for whole set
    itemUrl longblob not null,	# URL for item.  Put %s where image.submitId should go
              #Indices
    PRIMARY KEY(id),
    INDEX(journal)
);

#Association between contributors and submissionSets
CREATE TABLE submissionContributor (
    submissionSet int not null,	# ID in submissionSet table
    contributor int not null,	# ID in contributor table
              #Indices
    INDEX(submissionSet),
    INDEX(contributor)
);

#Info on a bunch of sections through same sample
CREATE TABLE sectionSet (
    id int auto_increment not null,	# Section id
              #Indices
    PRIMARY KEY(id)
);

#Information on an antibody
CREATE TABLE antibody (
    id int auto_increment not null,	# Antibody ID
    name varchar(255) not null,	# Name of antibody
    description longblob not null,	# Description of antibody
    taxon int not null,	# Taxon of animal antibody is from
              #Indices
    PRIMARY KEY(id)
);

#Info on a gene
CREATE TABLE gene (
    id int auto_increment not null,	# ID of gene
    name varchar(255) not null,	# Gene symbol (HUGO if available)
    locusLink varchar(255) not null,	# NCBI locus link ID or blank if none
    refSeq varchar(255) not null,	# RefSeq ID or blank if none
    genbank varchar(255) not null,	# Genbank/EMBL accession or blank if none
    uniProt varchar(255) not null,	# SwissProt/Uniprot accession or blank if none
    taxon int not null,	# NCBI taxon ID of organism
              #Indices
    PRIMARY KEY(id),
    INDEX(name(16)),
    INDEX(locusLink(8)),
    INDEX(genbank(12)),
    INDEX(uniProt(12))
);

# A synonym for a gene
CREATE TABLE geneSynonym (
    gene int not null,	#ID in gene table
    name varchar(255) not null, #Synonymous name for gene
              #Indices
    INDEX(gene),
    INDEX(name(16))
);


#Info on a probe
CREATE TABLE probe (
    id int auto_increment not null,	# ID of probe
    gene int not null,	# Associated gene if any
    antibody int not null,	# Associated antibody if any
    fPrimer varchar(255) not null,	# Forward PCR primer if any
    rPrimer varchar(255) not null,	# Reverse PCR primer if any
    seq longblob not null,	# Associated sequence if any
    probeType int not null,	# Type of probe
              #Indices
    PRIMARY KEY(id),
    INDEX(gene)
);

#What color probe is in
CREATE TABLE probeColor (
    id int auto_increment not null,	# ID of probeColor
    name varchar(255) not null,	# Name of probeColor
              #Indices
    PRIMARY KEY(id),
    UNIQUE(name(16))
);


#A file of biological images
CREATE TABLE imageFile (
    id int auto_increment not null,  # ID of image file
    fileName varchar(255) not null,	# Image file name not including directory
    priority float not null,    # Lower priorities are displayed first
    fullLocation int not null,	# Location of full-size image
    screenLocation int not null,	# Location of screen-sized image
    thumbLocation int not null,	# Location of thumbnail-sized image
    submissionSet int not null,	# Submission set this is part of
    submitId varchar(255) not null,	# ID within submission set
              #Indices
    PRIMARY KEY(id),
    INDEX(submitId),
    INDEX(submissionSet)
);

#An image.  There may be multiple images within an imageFile
CREATE TABLE image (
    id int auto_increment not null,	# ID of image
    imageFile int not null,     # ID of image file
    imagePos int not null,	# Position in image file, starting with 0
    sectionSet int not null,	# Set of sections this is part of or 0 if none
    sectionIx int not null,	# Position (0 based) within set of sections
    taxon int not null,	# NCBI taxon ID of organism
    isEmbryo tinyint not null,	# TRUE if embryonic.  Age will be relative to conception
    age float not null,	# Age in days since birth or conception depending on isEmbryo
    bodyPart int not null,	# Part of body image comes from
    sliceType int not null,	# How section is sliced
    treatment int not null,	# How section is treated
              #Indices
    PRIMARY KEY(id),
    INDEX(imageFile),
    INDEX(bodyPart),
    INDEX(sectionSet),
    INDEX(taxon),
    INDEX(age)
);

# Associate probe and image
CREATE TABLE imageProbe (
    image int not null,	# ID of image
    probe int not null, # ID of probe
    probeColor int not null, # ID of probeColor
         #indices
    INDEX(image),
    INDEX(probe),
    INDEX(probeColor)
); 
